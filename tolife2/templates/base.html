{% load static i18n %}
{% load django_htmx %}
{% load render_bundle from webpack_loader %}

<!DOCTYPE html>
{% get_current_language as LANGUAGE_CODE %}
<html lang="{{ LANGUAGE_CODE }}">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>
      {% block title %}
        TOLIFE
      {% endblock title %}
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="TOLIFE Platform" />
    <meta name="author" content="Jenny Haro" />
    <link rel="icon" href="{% static 'images/favicons/favicon.ico' %}" />
    {% block css %}
      <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}" />
      <link rel="stylesheet" href="{% static 'css/bootstrap-icons.css' %}" />
      <link rel="stylesheet" href="{% static 'css/bootstrap-icons.min.css' %}" />
    {% endblock css %}
    {% block javascript %}
      <script src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.5/dist/htmx.min.js"></script>
    {% endblock javascript %}
    <style>
      body {
        background-color: #f8fbfd;
      }

      .sidebar {
        height: 100vh;
        background-color: #ffffff;
        border-right: 1px solid #dee2e6;
        min-width: 200px;
        max-width: 200px;
        transition: all 0.3s ease;
      }

      .sidebar.collapsed {
        min-width: 60px;
        max-width: 60px;
      }

      .sidebar .nav-link.active {
        background-color: #d4f0fa;
        font-weight: 600;
        color: #000;
      }

      .sidebar .nav-link {
        color: #555;
        white-space: nowrap;
      }

      .sidebar .menu-text {
        transition: opacity 0.3s ease;
      }

      .sidebar.collapsed .menu-text {
        opacity: 0;
        visibility: hidden;
        width: 0;
        display: inline-block;
      }

      .sidebar.collapsed .logo-text {
        display: none;
      }

      .header {
        background-color: #fff;
        border-bottom: 1px solid #dee2e6;
        padding: 1rem;
      }

      .toggle-btn {
        background: none;
        border: none;
        font-size: 1.25rem;
        cursor: pointer;
        color: #555;
      }
    </style>
  </head>
  <body class="{% block bodyclass %}{% endblock bodyclass %}">
    {% block body %}
      <div class="d-flex">
        <!-- Sidebar -->
        <div id="sidebar" class="sidebar p-3 d-flex flex-column">
          <div class="text-center mb-4">
            <img src="{% static 'images/logos/TOLIFE_logo.png' %}"
                 alt="Logo"
                 height="50px" />
            <div class="logo-text mt-2">TOLIFE</div>
          </div>
          {% block menu_sidebar %}
            {% include 'design_system/molecule/base_menu_sidebar.html' %}
          {% endblock menu_sidebar %}
          <div class="mt-auto text-center">
            <div class="row align-items-center">
              <div id="eu-col" class="col-5 p-0">
                <img src="{% static 'images/logos/union-europea.png' %}"
                     alt="EU"
                     class="img-fluid" />
              </div>
              <div class="col-7 p-0">
                <small class="d-block text-muted mt-1 menu-text text-left">Funded by the European Union</small>
              </div>
            </div>
          </div>
        </div>
        <!-- Main -->
        <div class="flex-grow-1 d-flex flex-column">
          <!-- Header -->
          <header class="header d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center">
              <button class="toggle-btn me-3"
                      onclick="toggleSidebar()"
                      aria-label="Toggle sidebar">
                <i class="bi bi-list"></i>
              </button>
              <h6 class="m-0 text-muted">
                CLINICAL STUDY A - <span class="text-success">PROGRESS T9</span>
              </h6>
            </div>
            <div class="d-flex align-items-center">
              <span class="me-2">Name Surname</span>
              <span class="badge bg-secondary">TECHNICIAN</span>
              <img src="https://ui-avatars.com/api/?name=Jon+Snow&background=0D8ABC&color=fff&size=128"
                   class="rounded-circle ms-2"
                   alt="User Avatar"
                   width="40" />
            </div>
          </header>
          <!-- Page Content -->
          <main class="p-4 flex-grow-1">
            {% if messages %}
              {% for message in messages %}
                <div class="alert alert-dismissible {% if message.tags %}alert-{{ message.tags }}{% endif %}">
                  {{ message }}
                  <button type="button"
                          class="btn-close"
                          data-bs-dismiss="alert"
                          aria-label="Close"></button>
                </div>
              {% endfor %}
            {% endif %}
            {% block main %}
              {% block content %}
                <div id="id-main-content"></div>
              {% endblock content %}
            {% endblock main %}
          </main>
        </div>
      </div>
    {% endblock body %}
    {% block modal %}
    {% endblock modal %}
    {% block inline_javascript %}
      <script src="{% static 'js/bootstrap.min.js' %}"></script>
      <script src="{% static 'js/base/toggle_sidebar.js' %}"></script>
    {% endblock inline_javascript %}
  </body>
</html>
